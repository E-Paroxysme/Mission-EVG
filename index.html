<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SYSTÈME SÉCURISÉ</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=VT323&display=swap');
    :root {
      --green: #00ff41; --green-dim: #00cc33; --green-dark: #003b00;
      --green-glow: #00ff4188; --bg: #000; --red: #ff2200; --amber: #ffb000;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      background:var(--bg); color:var(--green);
      font-family:'Share Tech Mono',monospace; min-height:100vh; overflow-x:hidden;
      animation: flicker 9s infinite;
    }
    body::before {
      content:''; position:fixed; top:0; left:0; width:100%; height:100%;
      background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.13) 2px,rgba(0,0,0,0.13) 4px);
      pointer-events:none; z-index:9999;
    }
    @keyframes flicker { 0%,100%{opacity:1} 92%{opacity:1} 93%{opacity:.85} 94%{opacity:1} 97%{opacity:.92} 98%{opacity:1} }
    #terminal { max-width:860px; margin:0 auto; padding:20px 24px; min-height:100vh; }
    .line { margin:2px 0; line-height:1.65; font-size:15px; text-shadow:0 0 8px var(--green-glow); }
    .line.dim { color:var(--green-dim); }
    .line.bright { color:#fff; text-shadow:0 0 12px #fff8; }
    .line.red { color:var(--red); text-shadow:0 0 8px #ff220088; }
    .line.amber { color:var(--amber); text-shadow:0 0 8px #ffb00088; }
    .line.success { color:var(--green); font-family:'VT323',monospace; font-size:22px; text-shadow:0 0 18px var(--green); }
    .line.error { color:var(--red); }
    .line.separator { color:var(--green-dark); text-shadow:none; margin:6px 0; }
    .ascii-title {
      font-family:'VT323',monospace;
      font-size:clamp(72px,18vw,140px);
      color:var(--green);
      text-align:center;
      letter-spacing:0.25em;
      margin:20px 0 8px;
      line-height:1;
      /* IBM-style horizontal stripes cutting through the letters */
      background:
        repeating-linear-gradient(
          180deg,
          var(--green)    0px,
          var(--green)    10px,
          transparent     10px,
          transparent     15px
        );
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      filter: drop-shadow(0 0 18px var(--green)) drop-shadow(0 0 40px var(--green-glow));
    }
    .ascii-sub {
      font-family:'VT323',monospace; font-size:20px; color:var(--green-dim);
      text-align:center; letter-spacing:0.3em; margin-bottom:18px;
    }
    .input-row { display:flex; align-items:center; gap:8px; margin-top:16px; }
    .prompt { color:var(--green-dim); white-space:nowrap; }
    input[type="text"] {
      background:transparent; border:none; border-bottom:1px solid var(--green);
      color:var(--green); font-family:'Share Tech Mono',monospace; font-size:15px;
      outline:none; width:300px; padding:2px 6px;
      text-shadow:0 0 8px var(--green-glow); caret-color:var(--green); letter-spacing:2px;
    }
    button {
      background:transparent; border:1px solid var(--green); color:var(--green);
      font-family:'Share Tech Mono',monospace; font-size:13px; padding:4px 14px;
      cursor:pointer; transition:all 0.15s; letter-spacing:1px;
    }
    button:hover { background:var(--green); color:#000; box-shadow:0 0 12px var(--green-glow); }
    .progress-bar { display:flex; align-items:center; gap:10px; margin:12px 0; }
    .bar-track { flex:1; height:6px; background:var(--green-dark); border:1px solid var(--green-dim); overflow:hidden; }
    .bar-fill { height:100%; background:var(--green); box-shadow:0 0 8px var(--green-glow); transition:width 0.8s ease; }
    .bar-label { font-size:12px; color:var(--green-dim); white-space:nowrap; }
    #timer-display {
      font-family:'VT323',monospace; font-size:52px; color:var(--amber);
      text-shadow:0 0 24px #ffb00099; text-align:center; margin:20px 0; letter-spacing:4px;
    }
    #dday-message {
      font-family:'VT323',monospace; font-size:34px; color:var(--red);
      text-shadow:0 0 20px #ff220099; text-align:center; margin:20px 0; letter-spacing:3px;
      display:none; animation:alertPulse 1.2s ease infinite;
    }
    @keyframes alertPulse { 0%,100%{opacity:1} 50%{opacity:0.35} }
    @keyframes glitch {
      0%{transform:translate(0)} 20%{transform:translate(-2px,1px)}
      40%{transform:translate(2px,-1px)} 60%{transform:translate(-1px,2px)}
      80%{transform:translate(1px,-2px)} 100%{transform:translate(0)}
    }
    .glitch { animation:glitch 0.3s ease; }
    @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    .fade-in { animation:fadeIn 0.4s ease; }
    .gps-blanks {
      font-family:'Share Tech Mono',monospace; font-size:17px; color:var(--green);
      text-shadow:0 0 10px var(--green-glow); letter-spacing:5px; margin:14px 0 2px;
    }
    @media (max-width: 600px) {
      #terminal { padding: 12px 14px; }
      .line { font-size: 13px; }
      input[type="text"] { width: 180px; font-size: 13px; }
      button { font-size: 12px; padding: 4px 10px; }
      #timer-display { font-size: 36px; letter-spacing: 2px; }
      #dday-message { font-size: 22px; letter-spacing: 1px; }
      .gps-blanks { font-size: 14px; letter-spacing: 3px; }
      .ascii-sub { font-size: 13px; letter-spacing: 0.15em; }
      .input-row { flex-wrap: wrap; gap: 6px; }
    }
  </style>
</head>
<body>
<div id="terminal">
  <div id="output"></div>
  <div id="input-area"></div>
</div>
<script>
// ═══════════════════════════════════
// MOTS DE PASSE — hashés en SHA-256
// MORT | BARBE BLANCHE | EXCALIBUR | ALEXANDRE PACHECO | ZOEISAAC
// ═══════════════════════════════════
const REAL_HASHES = {};

async function sha256(str){
  const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
}

async function initHashes(){
  REAL_HASHES.step1 = await sha256('MORT');
  REAL_HASHES.step2 = await sha256('BARBE BLANCHE');
  REAL_HASHES.step3 = await sha256('EXCALIBUR');
  REAL_HASHES.step4 = await sha256('ALEXANDRE PACHECO');
  REAL_HASHES.step5 = await sha256('ZOEISAAC');
}

const TARGET_DATE = new Date('2026-04-10T08:00:00');
const DDAY_START  = new Date('2026-04-10T08:00:00');
const DDAY_END    = new Date('2026-04-10T23:59:59');
let timerInterval = null;

const output    = document.getElementById('output');
const inputArea = document.getElementById('input-area');

function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }

// ═══════════════════════════════════
// SOUND — bruit terminal
// ═══════════════════════════════════
let audioCtx = null;
function getAudioCtx(){
  if(!audioCtx) audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  return audioCtx;
}
function playTick(){
  try {
    const ctx = getAudioCtx();
    const buf = ctx.createBuffer(1, ctx.sampleRate * 0.012, ctx.sampleRate);
    const data = buf.getChannelData(0);
    for(let i=0;i<data.length;i++) data[i] = (Math.random()*2-1) * (1 - i/data.length);
    const src = ctx.createBufferSource();
    src.buffer = buf;
    src.playbackRate.value = 0.85 + Math.random() * 0.35;
    const gain = ctx.createGain();
    gain.gain.value = 0.08;
    src.connect(gain);
    gain.connect(ctx.destination);
    src.start();
  } catch(e){}
}

function playStartup(){
  try {
    const ctx = getAudioCtx();
    const now = ctx.currentTime;

    // 1. Bourdonnement grave qui monte (ventilateur qui démarre)
    const osc1 = ctx.createOscillator();
    const gain1 = ctx.createGain();
    osc1.type = 'sawtooth';
    osc1.frequency.setValueAtTime(40, now);
    osc1.frequency.linearRampToValueAtTime(120, now + 1.2);
    gain1.gain.setValueAtTime(0, now);
    gain1.gain.linearRampToValueAtTime(0.15, now + 0.3);
    gain1.gain.linearRampToValueAtTime(0.08, now + 1.4);
    gain1.gain.linearRampToValueAtTime(0, now + 2.0);
    osc1.connect(gain1); gain1.connect(ctx.destination);
    osc1.start(now); osc1.stop(now + 2.0);

    // 2. Bruit blanc (ventilateur / disque dur)
    const bufLen = ctx.sampleRate * 2.5;
    const noiseBuf = ctx.createBuffer(1, bufLen, ctx.sampleRate);
    const noiseData = noiseBuf.getChannelData(0);
    for(let i=0;i<bufLen;i++) noiseData[i] = Math.random()*2-1;
    const noiseSrc = ctx.createBufferSource();
    noiseSrc.buffer = noiseBuf;
    const noiseGain = ctx.createGain();
    // filtre passe-bas pour rendre le bruit plus "mécanique"
    const filter = ctx.createBiquadFilter();
    filter.type = 'lowpass';
    filter.frequency.value = 600;
    noiseGain.gain.setValueAtTime(0, now);
    noiseGain.gain.linearRampToValueAtTime(0.12, now + 0.5);
    noiseGain.gain.linearRampToValueAtTime(0.04, now + 1.8);
    noiseGain.gain.linearRampToValueAtTime(0, now + 2.5);
    noiseSrc.connect(filter); filter.connect(noiseGain); noiseGain.connect(ctx.destination);
    noiseSrc.start(now);

    // 3. Bip POST (bip de démarrage BIOS)
    const beep = ctx.createOscillator();
    const beepGain = ctx.createGain();
    beep.type = 'square';
    beep.frequency.value = 880;
    beepGain.gain.setValueAtTime(0, now + 1.0);
    beepGain.gain.linearRampToValueAtTime(0.18, now + 1.02);
    beepGain.gain.linearRampToValueAtTime(0, now + 1.18);
    beep.connect(beepGain); beepGain.connect(ctx.destination);
    beep.start(now + 1.0); beep.stop(now + 1.2);

  } catch(e){}
}
function scrollBottom(){ window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); }

function printRaw(text,cls=''){
  const d=document.createElement('div');
  d.className='line '+cls; d.textContent=text;
  output.appendChild(d); scrollBottom(); return d;
}
function printSep(){ printRaw('─'.repeat(62),'separator'); }

function typewrite(text,cls='',speed=26){
  return new Promise(resolve=>{
    const d=document.createElement('div');
    d.className='line '+cls; output.appendChild(d); scrollBottom();
    let i=0;
    const iv=setInterval(()=>{
      d.textContent+=text[i++]; playTick(); scrollBottom();
      if(i>=text.length){ clearInterval(iv); resolve(); }
    },speed);
  });
}

function clearInput(){ inputArea.innerHTML=''; }

function showInput(prompt,onSubmit){
  clearInput();
  const row=document.createElement('div');
  row.className='input-row fade-in';
  row.innerHTML=`<span class="prompt">${prompt}</span>
    <input type="text" id="main-input" autocomplete="off" autocorrect="off" spellcheck="false"/>
    <button onclick="submitInput()">ENTER</button>`;
  inputArea.appendChild(row);
  const inp=document.getElementById('main-input');
  inp.focus();
  inp.addEventListener('keydown',e=>{ if(e.key==='Enter') submitInput(); });
  window._onSubmit=onSubmit; scrollBottom();
}

function submitInput(){
  const inp=document.getElementById('main-input');
  if(!inp) return;
  const val=inp.value.trim().toUpperCase();
  clearInput(); printRaw('> '+val,'dim');
  if(window._onSubmit) window._onSubmit(val);
}

function showProgress(step){
  const ex=document.getElementById('prog'); if(ex) ex.remove();
  const pct=Math.round(step/5*100);
  const div=document.createElement('div');
  div.id='prog'; div.className='progress-bar fade-in';
  div.innerHTML=`<span class="bar-label">PROTOCOLES</span>
    <div class="bar-track"><div class="bar-fill" style="width:${pct}%"></div></div>
    <span class="bar-label">${step}/5</span>`;
  output.appendChild(div); scrollBottom();
}

async function checkStep(step,val){
  const h=await sha256(val);
  if(h===REAL_HASHES['step'+step]){
    await typewrite('✓  ACCÈS ACCORDÉ.','success');
    await sleep(250); showProgress(step); await sleep(450);
    if(step===1) startStep2();
    else if(step===2) startStep3();
    else if(step===3) startStep4();
    else if(step===4) startStep5();
    else if(step===5) startFinal();
  } else {
    const d=printRaw('✗  MOT DE PASSE INCORRECT. RÉESSAIE.','error glitch');
    setTimeout(()=>d.classList.remove('glitch'),400);
    await sleep(300);
    showInput('MOT DE PASSE > ',v=>checkStep(step,v));
  }
}

async function bootSequence(){
  const now=new Date();
  if(now>=DDAY_START && now<=DDAY_END){ showDDay(); return; }

  const titleDiv=document.createElement('div');
  titleDiv.className='ascii-title'; titleDiv.style.opacity='0';
  titleDiv.textContent='E.V.G'; output.appendChild(titleDiv);

  const subDiv=document.createElement('div');
  subDiv.className='ascii-sub'; subDiv.style.opacity='0';
  subDiv.textContent='[ SYSTÈME SÉCURISÉ — ACCÈS RESTREINT ]';
  output.appendChild(subDiv);

  await sleep(300);
  titleDiv.style.transition='opacity 1s ease'; titleDiv.style.opacity='1';
  subDiv.style.transition='opacity 1s ease'; subDiv.style.opacity='1';
  await sleep(1100);

  printSep();
  await typewrite("INITIALISATION DU SYSTÈME...",'dim');
  await sleep(250);
  await typewrite("CHARGEMENT DES PROTOCOLES DE SÉCURITÉ...",'dim');
  await sleep(200);
  await typewrite("DÉTECTION D'UN UTILISATEUR...",'dim');
  await sleep(400);
  await typewrite("IDENTIFIANT DÉTECTÉ : MAXIME",'bright');
  await sleep(200);
  await typewrite("STATUT : VERSION 1.0 — BUILD STABLE",'amber');
  await sleep(300);
  printSep();
  await sleep(200);
  await typewrite("AVERTISSEMENT : 5 PROTOCOLES DE SÉCURITÉ ACTIFS.",'red');
  await sleep(200);
  await typewrite("UNE QUÊTE T'ATTEND, AVENTURIER.",'');
  await sleep(300);
  await typewrite("PROUVE TA VALEUR.",'bright');
  await sleep(300);
  printSep();
  await sleep(400);
  showProgress(0);
  await sleep(400);
  startStep1();
}

async function startStep1(){
  await sleep(300); printRaw('');
  await typewrite("[ PROTOCOLE 1 / 5 ]",'amber');
  printRaw('');
  await typewrite("Dans la légende arthurienne, il est le chevalier au grand cœur",'');
  await typewrite("et à la naïveté légendaire.",'');
  await sleep(200);
  await typewrite("Kaamelott en a fait une icône comique.",'');
  await sleep(200);
  await typewrite("Nakaba Suzuki en a fait le Chevalier de la ___.",'bright');
  printRaw('');
  showInput('MOT DE PASSE > ',v=>checkStep(1,v));
}

async function startStep2(){
  await sleep(300); printRaw('');
  await typewrite("[ PROTOCOLE 2 / 5 ]",'amber');
  printRaw('');
  await typewrite("Il fut le seul homme au monde à avoir pu égaler le Roi des Pirates",'');
  await typewrite("dans un combat.",'');
  await sleep(300);
  await typewrite("Ses derniers mots ont fait trembler le monde entier.",'bright');
  printRaw('');
  showInput('MOT DE PASSE > ',v=>checkStep(2,v));
}

async function startStep3(){
  await sleep(300); printRaw('');
  await typewrite("[ PROTOCOLE 3 / 5 ]",'amber');
  printRaw('');
  await typewrite("Le système nécessite une clé externe.",'');
  await sleep(200);
  await typewrite("Tu es la Version 1.0. Stable. Fonctionnelle.",'');
  await sleep(200);
  await typewrite("Mais toute version a un ancêtre.",'');
  await sleep(300);
  await typewrite("Retrouve le build originel.",'bright');
  await sleep(200);
  await typewrite("Il a la clé.",'bright');
  printRaw('');
  showInput('MOT DE PASSE > ',v=>checkStep(3,v));
}

async function startStep4(){
  await sleep(300); printRaw('');
  await typewrite("[ PROTOCOLE 4 / 5 ]",'amber');
  printRaw('');
  await typewrite("40.1669° N,  7.7776° O",'bright');
  await sleep(500);

  // ALEXANDRE = 9 lettres | PACHECO = 7 lettres
  const blanksDiv=document.createElement('div');
  blanksDiv.className='line gps-blanks';
  blanksDiv.textContent='__________      _______';
  output.appendChild(blanksDiv);

  printRaw('');
  showInput('MOT DE PASSE > ',v=>checkStep(4,v));
  scrollBottom();
}

async function startStep5(){
  await sleep(300); printRaw('');
  await typewrite("[ PROTOCOLE 5 / 5 ]",'amber');
  printRaw('');
  await typewrite("Deux agents secrets ont infiltré la famille récemment.",'');
  await sleep(200);
  await typewrite("Niveau actuel : 0.  Expérience : 0.",'');
  await sleep(200);
  await typewrite("Niveau de menace : MAXIMUM.",'red');
  await sleep(300);
  await typewrite("Leur identité combinée déverrouille ce protocole.",'bright');
  printRaw('');
  showInput('MOT DE PASSE > ',v=>checkStep(5,v));
}

async function startFinal(){
  clearInput(); await sleep(400); printSep(); printRaw('');
  await typewrite("TOUS LES PROTOCOLES ONT ÉTÉ FRANCHIS.",'success');
  await sleep(300);
  await typewrite("DÉCHIFFREMENT DE LA DONNÉE TEMPORELLE...",'dim');
  await sleep(500);

  const loadDiv=printRaw('[░░░░░░░░░░░░░░░░░░░░] 0%','dim');
  for(let i=0;i<=100;i+=5){
    const f=Math.floor(i/5);
    loadDiv.textContent='['+'█'.repeat(f)+'░'.repeat(20-f)+'] '+i+'%';
    scrollBottom(); await sleep(55);
  }
  await sleep(400); printRaw('');
  await typewrite("DONNÉE TEMPORELLE CRITIQUE DÉCHIFFRÉE.",'bright');
  await sleep(300);
  await typewrite("Le système a détecté un événement classé ULTRA SECRET.",'');
  await sleep(200);
  await typewrite("DÉBUT DE L'INTERVENTION DANS :",'amber');
  await sleep(500);
  printSep(); await sleep(300);

  const timerDiv=document.createElement('div');
  timerDiv.id='timer-display'; output.appendChild(timerDiv);
  updateTimer(timerDiv);
  timerInterval=setInterval(()=>updateTimer(timerDiv),1000);
  await sleep(200);
  printRaw('■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■ ■','success');
  scrollBottom();
}

function updateTimer(el){
  const now=new Date(); const diff=TARGET_DATE-now;
  if(diff<=0){ el.textContent='00j 00h 00m 00s'; clearInterval(timerInterval); return; }
  const d=Math.floor(diff/86400000);
  const h=Math.floor((diff%86400000)/3600000);
  const m=Math.floor((diff%3600000)/60000);
  const s=Math.floor((diff%60000)/1000);
  el.textContent=String(d).padStart(2,'0')+'j  '+String(h).padStart(2,'0')+'h  '+String(m).padStart(2,'0')+'m  '+String(s).padStart(2,'0')+'s';
}

async function showDDay(){
  const titleDiv=document.createElement('div');
  titleDiv.className='ascii-title'; titleDiv.textContent='E.V.G';
  output.appendChild(titleDiv);
  await sleep(600); printSep(); await sleep(400);

  const msg=document.createElement('div');
  msg.id='dday-message'; msg.style.display='block';
  msg.textContent='⚠  ILS ARRIVENT POUR VOUS CHERCHER !  ⚠';
  output.appendChild(msg);
  await sleep(600);
  await typewrite("PRÉPAREZ-VOUS.",'red');
  await sleep(400);
  await typewrite("L'opération commence maintenant.",'amber');
  await sleep(300);
  printSep(); scrollBottom();
}

window.addEventListener('load',async()=>{
  await initHashes();

  // Écran de démarrage — débloque l'audio avant tout
  const splash = document.createElement('div');
  splash.id = 'splash';
  splash.style.cssText = `
    position:fixed; inset:0; background:#000; z-index:99999;
    display:flex; flex-direction:column; align-items:center; justify-content:center; gap:32px;
  `;
  splash.innerHTML = `
    <div style="font-family:'VT323',monospace;font-size:clamp(72px,18vw,140px);color:#00ff41;
      letter-spacing:0.25em;
      background:repeating-linear-gradient(180deg,#00ff41 0px,#00ff41 10px,transparent 10px,transparent 15px);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;
      filter:drop-shadow(0 0 18px #00ff41) drop-shadow(0 0 40px #00ff4188);">E.V.G</div>
    <div style="font-family:'VT323',monospace;font-size:20px;color:#00cc33;letter-spacing:0.3em;">
      [ SYSTÈME SÉCURISÉ — ACCÈS RESTREINT ]
    </div>
    <button id="launch-btn" style="
      margin-top:16px; background:transparent; border:1px solid #00ff41; color:#00ff41;
      font-family:'Share Tech Mono',monospace; font-size:15px; padding:12px 36px;
      cursor:pointer; letter-spacing:3px; transition:all 0.15s;
      text-shadow:0 0 8px #00ff4188;
    " onmouseover="this.style.background='#00ff41';this.style.color='#000';"
       onmouseout="this.style.background='transparent';this.style.color='#00ff41';">
      ▶  INITIALISER
    </button>
  `;
  document.body.appendChild(splash);

  document.getElementById('launch-btn').addEventListener('click', async () => {
    // Débloquer et lancer le son de démarrage
    getAudioCtx();
    playStartup();
    // Transition splash
    splash.style.transition = 'opacity 0.8s ease';
    splash.style.opacity = '0';
    setTimeout(()=>splash.remove(), 800);
    await sleep(400);
    bootSequence();
  });
});
</script>
</body>
</html>
